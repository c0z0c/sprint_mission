<script></script>

  // 파일 아이콘 및 타입 결정 함수// 파일 아이콘 및 타입 결정 함수

  function getFileInfo(extname) {  function getFileInfo(extname) {

    switch(extname.toLowerCase()) {    switch(extname.toLowerCase()) {

      case '.ipynb':      case '.ipynb':

        return { icon: '📓', type: 'Colab' };        return { icon: '📓', type: 'Colab' };

      case '.py':      case '.py':

        return { icon: '🐍', type: 'Python' };        return { icon: '🐍', type: 'Python' };

      case '.md':      case '.md':

        return { icon: '📝', type: 'Markdown' };        return { icon: '📝', type: 'Markdown' };

      case '.json':      case '.json':

        return { icon: '⚙️', type: 'JSON' };        return { icon: '⚙️', type: 'JSON' };

      case '.zip':      case '.zip':

        return { icon: '📦', type: '압축' };        return { icon: '📦', type: '압축' };

      case '.png':      case '.png':

      case '.jpg':      case '.jpg':

      case '.jpeg':      case '.jpeg':

        return { icon: '🖼️', type: '이미지' };        return { icon: '🖼️', type: '이미지' };

      case '.csv':      case '.csv':

        return { icon: '📊', type: '데이터' };        return { icon: '📊', type: '데이터' };

      case '.pdf':      case '.pdf':

        return { icon: '📄', type: 'PDF' };        return { icon: '📄', type: 'PDF' };

      case '.docx':      case '.docx':

        return { icon: '📊', type: 'Word' };        return { icon: '�', type: 'Word' };

      case '.pptx':      case '.pptx':

        return { icon: '📊', type: 'PowerPoint' };        return { icon: '📊', type: 'PowerPoint' };

      case '.xlsx':      case '.xlsx':

        return { icon: '📈', type: 'Excel' };        return { icon: '📈', type: 'Excel' };

      case '.hwp':      case '.hwp':

        return { icon: '📄', type: 'HWP' };        return { icon: '📄', type: 'HWP' };

      case '.txt':      case '.txt':

        return { icon: '📄', type: 'Text' };        return { icon: '📄', type: 'Text' };

      case '.html':      case '.html':

        return { icon: '🌐', type: 'HTML' };        return { icon: '🌐', type: 'HTML' };

      default:      default:

        return { icon: '📄', type: '파일' };        return { icon: '📄', type: '파일' };

    }    }

  }  }



  // CSV 뷰어 함수  // 온라인 뷰어로 파일 보기 함수

  function openCSVViewer(fileName) {  function openGoogleSheetsViewer(fileName) {

    const modal = createViewerModal('CSV 뷰어 - ' + fileName);    const githubRawUrl = `${raw_url}${fileName}`;

    const content = modal.querySelector('.viewer-content');    // Google Sheets Import 기능 사용

        const googleSheetsUrl = `https://docs.google.com/spreadsheets/d/e/2PACX-1vT7fUCH9Z_pX8K2vJ7Z3uE4fUCH9Z_pX8K2vJ7Z3uE4/pubhtml?embedded=true&url=${encodeURIComponent(githubRawUrl)}`;

    fetch(raw_url + fileName)    window.open(googleSheetsUrl, '_blank');

      .then(response => response.text())  }

      .then(data => {

        const rows = data.split('\\n').map(row => row.split(','));  // CSV 뷰어 함수

        let html = '<table border="1" style="border-collapse: collapse; width: 100%;">';  function openCSVViewer(fileName) {

        rows.forEach((row, index) => {    const modal = createViewerModal(`CSV 뷰어 - ${fileName}`);

          html += '<tr>';    const content = modal.querySelector('.viewer-content');

          row.forEach(cell => {    

            const tag = index === 0 ? 'th' : 'td';    fetch(`${raw_url}${fileName}`)

            html += '<' + tag + ' style="padding: 8px; border: 1px solid #ddd;">' + cell.trim() + '</' + tag + '>';      .then(response => response.text())

          });      .then(data => {

          html += '</tr>';        const rows = data.split('\n').map(row => row.split(','));

        });        let html = '<table border="1" style="border-collapse: collapse; width: 100%;">';

        html += '</table>';        rows.forEach((row, index) => {

        content.innerHTML = html;          html += '<tr>';

      })          row.forEach(cell => {

      .catch(error => {            const tag = index === 0 ? 'th' : 'td';

        content.innerHTML = '<p>CSV 파일을 로드할 수 없습니다: ' + error.message + '</p>';            html += `<${tag} style="padding: 8px; border: 1px solid #ddd;">${cell.trim()}</${tag}>`;

      });          });

  }          html += '</tr>';

        });

  // JSON 뷰어 함수        html += '</table>';

  function openJSONViewer(fileName) {        content.innerHTML = html;

    const modal = createViewerModal('JSON 뷰어 - ' + fileName);      })

    const content = modal.querySelector('.viewer-content');      .catch(error => {

            content.innerHTML = `<p>CSV 파일을 로드할 수 없습니다: ${error.message}</p>`;

    fetch(raw_url + fileName)      });

      .then(response => response.json())  }

      .then(data => {

        content.innerHTML = '<pre style="background: #f5f5f5; padding: 20px; border-radius: 5px; overflow: auto;">' + JSON.stringify(data, null, 2) + '</pre>';  // JSON 뷰어 함수

      })  function openJSONViewer(fileName) {

      .catch(error => {    const modal = createViewerModal(`JSON 뷰어 - ${fileName}`);

        content.innerHTML = '<p>JSON 파일을 로드할 수 없습니다: ' + error.message + '</p>';    const content = modal.querySelector('.viewer-content');

      });    

  }    fetch(`${raw_url}${fileName}`)

      .then(response => response.json())

  // 모달 생성 함수      .then(data => {

  function createViewerModal(title) {        content.innerHTML = `<pre style="background: #f5f5f5; padding: 20px; border-radius: 5px; overflow: auto;">${JSON.stringify(data, null, 2)}</pre>`;

    const modal = document.createElement('div');      })

    modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; display: flex; align-items: center; justify-content: center;';      .catch(error => {

            content.innerHTML = `<p>JSON 파일을 로드할 수 없습니다: ${error.message}</p>`;

    modal.innerHTML = '<div style="background: white; width: 90%; height: 90%; border-radius: 10px; overflow: hidden;"><div style="background: #f0f0f0; padding: 15px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;"><h3 style="margin: 0;">' + title + '</h3><button onclick="this.closest(\\'div[style*=\\"position: fixed\\"]\\').remove()" style="background: #ff5f56; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">×</button></div><div class="viewer-content" style="padding: 20px; height: calc(100% - 70px); overflow: auto;"><p>로딩 중...</p></div></div>';      });

      }

    document.body.appendChild(modal);

    return modal;  // 모달 생성 함수

  }    function createViewerModal(title) {

    const modal = document.createElement('div');

  // DOM이 로드된 후 파일 목록 렌더링    modal.style.cssText = `

  document.addEventListener('DOMContentLoaded', function() {      position: fixed; top: 0; left: 0; width: 100%; height: 100%; 

    const fileGrid = document.querySelector('.file-grid');      background: rgba(0,0,0,0.8); z-index: 1000; display: flex; 

          align-items: center; justify-content: center;

    if (curFiles.length === 0) {    `;

      fileGrid.innerHTML = '<div class="empty-message"><span class="empty-icon">📄</span><h3>파일이 없습니다</h3><p>현재 이 위치에는 완료된 미션 파일이 없습니다.</p></div>';    

      return;    modal.innerHTML = `

    }      <div style="background: white; width: 90%; height: 90%; border-radius: 10px; overflow: hidden;">

        <div style="background: #f0f0f0; padding: 15px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;">

    let html = '<table class="file-table"><thead><tr><th onclick="sortTable(0)" style="cursor: pointer; width:110px;">날짜 ⬍</th><th onclick="sortTable(1)" style="cursor: pointer;">제목 ⬍</th><th onclick="sortTable(2)" style="cursor: pointer;">파일명 ⬍</th><th onclick="sortTable(3)" style="cursor: pointer;">타입 ⬍</th><th onclick="sortTable(4)" style="cursor: pointer;">View ⬍</th><th onclick="sortTable(5)" style="cursor: pointer;">Git⬍</th></tr></thead><tbody>';          <h3 style="margin: 0;">${title}</h3>

              <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="background: #ff5f56; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">×</button>

    curFiles.forEach(file => {        </div>

      if (file.name === 'index.md' || file.name === 'info.md') return;        <div class="viewer-content" style="padding: 20px; height: calc(100% - 70px); overflow: auto;">

          <p>로딩 중...</p>

      const fileInfo = getFileInfo(file.extname);        </div>

      const fileDate = file.modified_time ? new Date(file.modified_time).toLocaleDateString('ko-KR') : '';      </div>

      const fileName = file.name;    `;

      const fileExt = file.extname.toLowerCase();    

          document.body.appendChild(modal);

      // 렌더링페이지 링크 생성    return modal;

      let renderLink = '';  }  

      if (fileExt === '.md' && fileName !== 'index.md') {

        const mdName = fileName.replace('.md', '');

        renderLink = '<a href="' + site_url + mdName + '" title="렌더링된 페이지 보기" target="_blank">🌐</a>';

      } else if (fileExt === '.ipynb') {  // DOM이 로드된 후 파일 목록 렌더링

        renderLink = '<a href="' + colab_url + fileName + '" title="Colab에서 열기" target="_blank">🚀</a>';  document.addEventListener('DOMContentLoaded', function() {

      } else if (fileExt === '.pdf') {    const fileGrid = document.querySelector('.file-grid');

        renderLink = '<a href="https://docs.google.com/viewer?url=' + raw_url + fileName + '" title="PDF 뷰어로 열기" target="_blank">📄</a>';    

      } else if (fileExt === '.docx') {    if (curFiles.length === 0) {

        renderLink = '<a href="https://docs.google.com/viewer?url=' + raw_url + fileName + '" title="Google에서 열기" target="_blank">📊</a>';      fileGrid.innerHTML = `

      } else if (fileExt === '.html') {        <div class="empty-message">

        renderLink = '<a href="' + site_url + fileName + '" title="웹페이지로 보기" target="_blank">🌐</a>';          <span class="empty-icon">📄</span>

      } else if (fileExt === '.csv') {          <h3>파일이 없습니다</h3>

        renderLink = '<a href="javascript:openCSVViewer(\\'' + fileName + '\\')" title="CSV 데이터 보기">📊</a>';          <p>현재 이 위치에는 완료된 미션 파일이 없습니다.</p>

      } else if (fileExt === '.json') {        </div>

        renderLink = '<a href="javascript:openJSONViewer(\\'' + fileName + '\\')" title="JSON 뷰어로 보기">⚙️</a>';      `;

      } else if (['.png', '.jpg', '.jpeg', '.gif', '.svg'].includes(fileExt)) {      return;

        renderLink = '<a href="' + raw_url + fileName + '" title="이미지 보기" target="_blank">🖼️</a>';    }

      } else {

        renderLink = '-';    let html = `

      }      <table class="file-table">

              <thead>

      // Git 직접 링크          <tr>

      const gitLink = '<a href="' + git_url + fileName + '" title="GitHub에서 원본 보기" target="_blank">📖</a>';            <th onclick="sortTable(0)" style="cursor: pointer; width:110px;">날짜 ⬍</th>

                  <th onclick="sortTable(1)" style="cursor: pointer;">제목 ⬍</th>

      // 제목 클릭 시 렌더링 페이지 링크 생성            <th onclick="sortTable(2)" style="cursor: pointer;">파일명 ⬍</th>

      let titleClickable = '<span class="file-icon">' + fileInfo.icon + '</span> ' + (file.title || file.name);            <th onclick="sortTable(3)" style="cursor: pointer;">타입 ⬍</th>

      if (fileExt === '.md' && fileName !== 'index.md') {            <th onclick="sortTable(4)" style="cursor: pointer;">View ⬍</th>

        const mdName = fileName.replace('.md', '');            <th onclick="sortTable(5)" style="cursor: pointer;">Git⬍</th>

        titleClickable = '<span class="file-icon">' + fileInfo.icon + '</span> <a href="' + site_url + mdName + '" title="렌더링된 페이지 보기" target="_blank" style="text-decoration: none; color: inherit;">' + (file.title || file.name) + '</a>';          </tr>

      } else if (fileExt === '.ipynb') {        </thead>

        titleClickable = '<span class="file-icon">' + fileInfo.icon + '</span> <a href="' + colab_url + fileName + '" title="Colab에서 열기" target="_blank" style="text-decoration: none; color: inherit;">' + (file.title || file.name) + '</a>';        <tbody>

      } else if (fileExt === '.pdf') {    `;

        titleClickable = '<span class="file-icon">' + fileInfo.icon + '</span> <a href="https://docs.google.com/viewer?url=' + raw_url + fileName + '" title="PDF 뷰어로 열기" target="_blank" style="text-decoration: none; color: inherit;">' + (file.title || file.name) + '</a>';    

      } else if (fileExt === '.docx') {    curFiles.forEach(file => {

        titleClickable = '<span class="file-icon">' + fileInfo.icon + '</span> <a href="https://docs.google.com/viewer?url=' + raw_url + fileName + '" title="Google에서 열기" target="_blank" style="text-decoration: none; color: inherit;">' + (file.title || file.name) + '</a>';      if (file.name === 'index.md' || file.name === 'info.md') return;

      } else if (fileExt === '.html') {

        titleClickable = '<span class="file-icon">' + fileInfo.icon + '</span> <a href="' + site_url + fileName + '" title="웹페이지로 보기" target="_blank" style="text-decoration: none; color: inherit;">' + (file.title || file.name) + '</a>';      const fileInfo = getFileInfo(file.extname);

      }      const fileDate = file.modified_time ? new Date(file.modified_time).toLocaleDateString('ko-KR') : '';

            const fileName = file.name;

      // 파일명 클릭 시 Git 직접 연결      const fileExt = file.extname.toLowerCase();

      const fileNameClickable = '<a href="' + git_url + fileName + '" title="GitHub에서 원본 보기" target="_blank" style="text-decoration: none; color: inherit;">' + fileName + '</a>';      

            // 렌더링페이지 링크 생성

      html += '<tr><td>' + fileDate + '</td><td>' + titleClickable + '</td><td>' + fileNameClickable + '</td><td>' + fileInfo.type + '</td><td>' + renderLink + '</td><td>' + gitLink + '</td></tr>';      let renderLink = '';

    });      if (fileExt === '.md' && fileName !== 'index.md') {

            const mdName = fileName.replace('.md', '');

    html += '</tbody></table>';        renderLink = `<a href="${site_url}${mdName}" title="렌더링된 페이지 보기" target="_blank">🌐</a>`;

          } else if (fileExt === '.ipynb') {

    fileGrid.innerHTML = html;        renderLink = `<a href="${colab_url}${fileName}" title="Colab에서 열기" target="_blank">🚀</a>`;

  });      } else if (fileExt === '.pdf') {

        renderLink = `<a href="https://docs.google.com/viewer?url=${raw_url}${fileName}" title="PDF 뷰어로 열기" target="_blank">📄</a>`;

  // 테이블 정렬 기능      } else if (fileExt === '.docx') {

  let sortDirection = {}; // 각 컬럼의 정렬 방향을 저장        renderLink = `<a href="https://docs.google.com/viewer?url=${raw_url}${fileName}" title="Google에서 열기" target="_blank">📊</a>`;

      } else if (fileExt === '.html') {

  function sortTable(columnIndex) {        renderLink = `<a href="${site_url}${fileName}" title="웹페이지로 보기" target="_blank">🌐</a>`;

    const table = document.querySelector('.file-table');      } else if (fileExt === '.csv') {

    const tbody = table.querySelector('tbody');        renderLink = `<a href="javascript:openCSVViewer('${fileName}')" title="CSV 데이터 보기">📊</a>`;

    const rows = Array.from(tbody.querySelectorAll('tr'));      } else if (fileExt === '.json') {

            renderLink = `<a href="javascript:openJSONViewer('${fileName}')" title="JSON 뷰어로 보기">⚙️</a>`;

    // 현재 정렬 방향 확인 (기본값: 오름차순)      } else if (['.png', '.jpg', '.jpeg', '.gif', '.svg'].includes(fileExt)) {

    const isAscending = sortDirection[columnIndex] !== 'asc';        renderLink = `<a href="${raw_url}${fileName}" title="이미지 보기" target="_blank">🖼️</a>`;

    sortDirection[columnIndex] = isAscending ? 'asc' : 'desc';      } else {

            renderLink = '-';

    // 헤더 화살표 업데이트      }

    const headers = table.querySelectorAll('th');      

    headers.forEach((header, index) => {      // Git 직접 링크

      if (index === columnIndex) {      const gitLink = `<a href="${git_url}${fileName}" title="GitHub에서 원본 보기" target="_blank">📖</a>`;

        const arrow = isAscending ? ' ⬆' : ' ⬇';      

        header.innerHTML = header.innerHTML.replace(/ [⬆⬇⬍]/g, '') + arrow;      // 제목 클릭 시 렌더링 페이지 링크 생성

      } else {      let titleClickable = `<span class="file-icon">${fileInfo.icon}</span> ${file.title || file.name}`;

        header.innerHTML = header.innerHTML.replace(/ [⬆⬇⬍]/g, '') + ' ⬍';      if (fileExt === '.md' && fileName !== 'index.md') {

      }        const mdName = fileName.replace('.md', '');

    });        titleClickable = `<span class="file-icon">${fileInfo.icon}</span> <a href="${site_url}${mdName}" title="렌더링된 페이지 보기" target="_blank" style="text-decoration: none; color: inherit;">${file.title || file.name}</a>`;

          } else if (fileExt === '.ipynb') {

    // 행 정렬        titleClickable = `<span class="file-icon">${fileInfo.icon}</span> <a href="${colab_url}${fileName}" title="Colab에서 열기" target="_blank" style="text-decoration: none; color: inherit;">${file.title || file.name}</a>`;

    rows.sort((a, b) => {      } else if (fileExt === '.pdf') {

      let aValue = a.cells[columnIndex].textContent || a.cells[columnIndex].innerText;        titleClickable = `<span class="file-icon">${fileInfo.icon}</span> <a href="https://docs.google.com/viewer?url=${raw_url}${fileName}" title="PDF 뷰어로 열기" target="_blank" style="text-decoration: none; color: inherit;">${file.title || file.name}</a>`;

      let bValue = b.cells[columnIndex].textContent || b.cells[columnIndex].innerText;      } else if (fileExt === '.docx') {

              titleClickable = `<span class="file-icon">${fileInfo.icon}</span> <a href="https://docs.google.com/viewer?url=${raw_url}${fileName}" title="Google에서 열기" target="_blank" style="text-decoration: none; color: inherit;">${file.title || file.name}</a>`;

      // 날짜 컬럼인 경우 날짜로 파싱      } else if (fileExt === '.html') {

      if (columnIndex === 0) {        titleClickable = `<span class="file-icon">${fileInfo.icon}</span> <a href="${site_url}${fileName}" title="웹페이지로 보기" target="_blank" style="text-decoration: none; color: inherit;">${file.title || file.name}</a>`;

        aValue = aValue ? new Date(aValue).getTime() : 0;      }

        bValue = bValue ? new Date(bValue).getTime() : 0;      

      }      // 파일명 클릭 시 Git 직접 연결

      // 숫자가 포함된 문자열의 경우 자연 정렬      const fileNameClickable = `<a href="${git_url}${fileName}" title="GitHub에서 원본 보기" target="_blank" style="text-decoration: none; color: inherit;">${fileName}</a>`;

      else {      

        // 아이콘 제거 (제목 컬럼의 경우)      html += `

        aValue = aValue.replace(/[📓🐍📝⚙️📦🖼️📊📄🌐]/g, '').trim();        <tr>

        bValue = bValue.replace(/[📓🐍📝⚙️📦🖼️📊📄🌐]/g, '').trim();          <td>${fileDate}</td>

      }          <td>${titleClickable}</td>

                <td>${fileNameClickable}</td>

      let comparison = 0;          <td>${fileInfo.type}</td>

      if (typeof aValue === 'number' && typeof bValue === 'number') {          <td>${renderLink}</td>

        comparison = aValue - bValue;          <td>${gitLink}</td>

      } else {        </tr>

        comparison = aValue.toString().localeCompare(bValue.toString(), 'ko-KR', {       `;

          numeric: true,     });

          caseFirst: 'lower'     

        });    html += `

      }        </tbody>

            </table>

      return isAscending ? comparison : -comparison;    `;

    });    

        fileGrid.innerHTML = html;

    // 정렬된 행들을 다시 tbody에 추가  });

    rows.forEach(row => tbody.appendChild(row));

  }  // 테이블 정렬 기능

</script>  let sortDirection = {}; // 각 컬럼의 정렬 방향을 저장

  function sortTable(columnIndex) {
    const table = document.querySelector('.file-table');
    const tbody = table.querySelector('tbody');
    const rows = Array.from(tbody.querySelectorAll('tr'));
    
    // 현재 정렬 방향 확인 (기본값: 오름차순)
    const isAscending = sortDirection[columnIndex] !== 'asc';
    sortDirection[columnIndex] = isAscending ? 'asc' : 'desc';
    
    // 헤더 화살표 업데이트
    const headers = table.querySelectorAll('th');
    headers.forEach((header, index) => {
      if (index === columnIndex) {
        const arrow = isAscending ? ' ⬆' : ' ⬇';
        header.innerHTML = header.innerHTML.replace(/ [⬆⬇⬍]/g, '') + arrow;
      } else {
        header.innerHTML = header.innerHTML.replace(/ [⬆⬇⬍]/g, '') + ' ⬍';
      }
    });
    
    // 행 정렬
    rows.sort((a, b) => {
      let aValue = a.cells[columnIndex].textContent || a.cells[columnIndex].innerText;
      let bValue = b.cells[columnIndex].textContent || b.cells[columnIndex].innerText;
      
      // 날짜 컬럼인 경우 날짜로 파싱
      if (columnIndex === 0) {
        aValue = aValue ? new Date(aValue).getTime() : 0;
        bValue = bValue ? new Date(bValue).getTime() : 0;
      }
      // 숫자가 포함된 문자열의 경우 자연 정렬
      else {
        // 아이콘 제거 (제목 컬럼의 경우)
        aValue = aValue.replace(/[📓🐍📝⚙️📦🖼️📊📄]/g, '').trim();
        bValue = bValue.replace(/[📓🐍📝⚙️📦🖼️📊📄]/g, '').trim();
      }
      
      let comparison = 0;
      if (typeof aValue === 'number' && typeof bValue === 'number') {
        comparison = aValue - bValue;
      } else {
        comparison = aValue.toString().localeCompare(bValue.toString(), 'ko-KR', { 
          numeric: true, 
          caseFirst: 'lower' 
        });
      }
      
      return isAscending ? comparison : -comparison;
    });
    
    // 정렬된 행들을 다시 tbody에 추가
    rows.forEach(row => tbody.appendChild(row));
  }

/*
<h2>� 하위 폴더 목록</h2>
<div class="folder-grid">
</div>
*/
