{% comment %} 현재 페이지의 디렉토리 경로를 가져온다 {% endcomment %} 

{% assign all_files = site.static_files %}
{% assign all_pages = site.all_pages_json %}

{% assign cur_file_dir = cur_dir %}
{% assign cur_page_dir = page.dir %}

{% if cur_file_dir == nil or cur_file_dir == "" %}
  {% assign cur_dirs = "" %}
  {% assign cur_files = "" %}
{% else %}

  {% assign cur_files = "" %}
  {% for f in all_files %}
    {% assign f_deep = f.path | split: "/" %}
    {% if f.dir | slice: 0, cur_file_dir | size == cur_file_dir %}
      {% assign cur_files = cur_files | push: f %}
    {% endif %}
  {% endfor %}

  {% assign cur_pages = "" %}
  {% for f in all_pages %}
    {% assign f_deep = f.path | split: "/" %}
    {% if f.dir | slice: 0, cur_page_dir | size == cur_page_dir %}
      {% assign cur_pages = cur_pages | push: f %}
    {% endif %}
  {% endfor %}

  {% capture cur_files_json %}
  [
  {% for f in cur_files %}
    {
      "name": {{ f.name | jsonify }},
      "path": {{ f.path | jsonify }},
      "extname": {{ f.extname | jsonify }},
      "modified_time": {{ f.modified_time | jsonify }},
      "basename": {{ f.basename | default: "" | jsonify }},
      "url": {{ f.url | default: "" | jsonify }}
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
  ]
  {% endcapture %}

  {% capture cur_pages_json %}
  [
  {% for p in cur_pages %}
    {
      "title": {{ p.title | jsonify }},
      "url": {{ p.url | jsonify }},
      "path": {{ p.path | jsonify }},
      "dir": {{ p.dir | jsonify }},
      "name": {{ p.name | default: "" | jsonify }},
      "layout": {{ p.layout | default: "" | jsonify }},
      "date": {{ p.date | default: "" | jsonify }},
      "excerpt": {{ p.excerpt | default: "" | jsonify }},
      "categories": {{ p.categories | default: "" | jsonify }},
      "tags": {{ p.tags | default: "" | jsonify }}
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
  ]
  {% endcapture %}

{% endif %}

