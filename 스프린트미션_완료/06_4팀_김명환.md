---
layout: default
title: 흉부 X-Ray 폐렴 분류 프로젝트 보고서
description: 흉부 X-Ray 폐렴 분류 프로젝트 보고서
cache-control: no-cache
expires: 0
pragma: no-cache
---

# 흉부 X-Ray 폐렴 분류 프로젝트 보고서

## 1. 연구 개요

### 1.1 연구 목적
흉부 X-Ray 이미지를 활용하여 폐렴을 자동으로 분류하는 딥러닝 모델을 개발하고, 다양한 Fine-Tuning 전략을 비교 분석하여 의료 현장에서 실용적으로 활용 가능한 최적 모델을 도출한다.

### 1.2 핵심 연구 질문
- 어떤 모델 아키텍처와 Fine-Tuning 전략이 폐렴 분류에 최적인가?
- 의료진단 관점에서 민감도와 특이도의 최적 균형점은 어디인가?
- 실제 임상 환경에서 배포 가능한 성능 수준은 달성 가능한가?

### 1.3 평가 지표
**의료진단 특화 지표**
- **민감도(Sensitivity)**: 폐렴 환자를 올바르게 진단하는 비율
- **특이도(Specificity)**: 정상 환자를 올바르게 진단하는 비율
- **위음성률**: 폐렴 환자를 놓치는 비율 (낮을수록 좋음)
- **위양성률**: 불필요한 추가 검사 비율

---

## 2. 데이터셋 및 전처리

### 2.1 원본 데이터 현황
**데이터 출처**: Kaggle Chest X-Ray Images (Pneumonia)
- **훈련**: 1,341개 Normal, 3,875개 Pneumonia (불균형 비율 1:2.89)
- **검증**: 8개 Normal, 8개 Pneumonia (통계적으로 부족)
- **테스트**: 234개 Normal, 390개 Pneumonia

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/데이타불균형.png"/>

### 2.2 데이터 품질 개선
**중복 데이터 제거**
- 훈련 세트: 26개 중복 제거 (Normal 1개, Pneumonia 25개)
- 테스트 세트: 6개 중복 제거 (각 클래스 3개씩)

**클래스 불균형 해소**
- 데이터 증강을 통한 완전 균형 달성 (1:1 비율)
- 검증 세트 대폭 확장 (16개 → 1,016개)

### 2.3 의료 특화 데이터 증강
**과학적 근거**
- 정상 폐 조직: 공기 충만으로 X-ray 투과율 높음 (밝은 이미지)
- 폐렴 조직: 염증 삼출물로 X-ray 투과율 낮음 (어두운 이미지)

**클래스별 차등 증강 전략**
- **Normal**: 밝기 증강 (+0.05 ~ +0.15)
- **Pneumonia**: 어두운 증강 (-0.15 ~ -0.05)
- **복합 증강**: 밝기 + 회전(±10도) 조합

**12가지 증강 전략 실험 결과**
- CLAHE, 가우시안 블러, 대비 조정, 회전 변환 등 체계적 비교
- **핵심 발견**: 클래스별 차등 밝기 조정이 가장 효과적

- 증강데이타 검토

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/brightness.png"/>

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/contrast.png"/>

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/rotation.png"/>

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/클레스별이미지셈플.png"/>

- 히스토그램 검토

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/히스토그램.png"/>


### 2.4 최종 데이터셋 구성
- **훈련**: 11,700개 (Normal 5,850개, Pneumonia 5,850개) - 완전 균형
- **검증**: 1,016개 (Normal 508개, Pneumonia 508개) - 통계적 유의성 확보
- **테스트**: 618개 (Normal 231개, Pneumonia 387개) - 원본 분포 유지

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/시험데이타균형.png"/>

---

## 3. 연구 방법론

### 3.1 실험 모델
**선정 모델 (4개)**
- **EfficientNet-B0**: 파라미터 효율성과 과적합 방지
- **DenseNet-121**: 특징 재사용을 통한 의료 이미지 최적화
- **ConvNeXt-Tiny**: 최신 아키텍처의 성능 검증
- **ResNet-50**: 의료 이미지 분야 검증된 기준 모델

### 3.2 Fine-Tuning 전략
**3가지 전략 체계적 비교**

| 전략 | 학습 대상 | 학습률 | 에포크 | 특징 |
|------|-----------|--------|--------|------|
| **Frozen** | 분류기만 | 0.001 | 10 | 빠른 학습, 과적합 방지 |
| **Partial** | 마지막 2개 층 + 분류기 | 0.0001 | 15 | 성능-효율성 균형 |
| **Full** | 전체 네트워크 | 0.00001 | 20 | 최대 성능 추구 |

### 3.3 학습 설정
- **해상도**: 512×512 (미세 병변 보존과 효율성 균형)
- **배치 크기**: 16
- **손실함수**: 가중 교차 엔트로피 (Normal:Pneumonia = 1:1.5)
- **옵티마이저**: Adam
- **스케줄러**: StepLR (step_size=7, gamma=0.1)
- **정규화**: 도메인 특화 (Mean: 0.3632, Std: 0.3119)

---

## 4. 실험 결과

### 4.1 전체 실험 결과 요약 (총 11개 모델 조합)

| 순위 | 모델 | 전략 | Test Acc | Val Acc | Sensitivity | Specificity | F1-Score |
|------|------|------|----------|---------|-------------|-------------|----------|
| 1 | **DenseNet-121** | Partial | **0.872** | 0.715 | 0.974 | **0.701** | **0.867** |
| 2 | **DenseNet-121** | Frozen | **0.867** | 0.822 | 0.992 | 0.658 | 0.860 |
| 3 | **ResNet-50** | Frozen | **0.841** | 0.715 | 0.951 | 0.658 | 0.835 |

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/모델성능비교.png"/>

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/시험_모델성능비교.png"/>

- Grad-CAM (참고)

<img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/Grad-CAM_정상.png" width="49%" height="49%"/> <img src="https://c0z0c.github.io/sprint_mission/스프린트미션_완료/image/06_4팀_김명환/Grad-CAM_폐암.png" width="49%" height="49%"/>


### 4.2 Fine-Tuning 전략별 분석

**Frozen (Feature Extractor) 전략**
- **최우수**: DenseNet-121 (Test Acc: 86.7%)
- **특징**: 안정적 성능, 빠른 학습, 과적합 위험 낮음
- **적용**: 프로토타이핑, 리소스 제한 환경

**Partial Fine-Tuning 전략**
- **최우수**: DenseNet-121 (Test Acc: 87.2%, **전체 최고**)
- **특징**: 최적의 성능-효율성 균형
- **적용**: 실제 임상 배포 환경

**Full Fine-Tuning 전략**
- **주의사항**: 과적합 경향 (검증-테스트 성능 차이 발생)
- **적용**: 연구 목적, 1차 스크리닝 전용

### 4.3 모델 아키텍처별 특성

**DenseNet-121 (전체 최우수)**
- 모든 Fine-Tuning 전략에서 일관된 고성능
- Dense connection으로 의료 이미지 미세 패턴 학습 최적화
- 안정적 일반화 성능

**ResNet-50**
- Frozen 전략에서 우수한 성능
- Partial에서 과적합 경향 (검증 90.7% vs 테스트 75.9%)

**EfficientNet-B0**
- 모든 전략에서 일관된 성능 (79.8~80.6%)
- 안정적이지만 최고 성능 달성 한계

---

## 5. 의료진단학적 해석

### 5.1 최우수 모델 성능 분석

**DenseNet-121 + Partial Fine-Tuning**
- **테스트 정확도**: 87.2%
- **민감도**: 97.4% (폐렴 환자 400명 중 390명 정확 진단)
- **특이도**: 70.1% (정상 환자 231명 중 162명 정확 진단)
- **위음성**: 10명 (폐렴 놓침, 허용 가능한 수준)
- **위양성**: 69명 (불필요한 추가 검사, 상대적으로 낮음)

### 5.2 임상적 의미

**민감도 관점**
- 97.4%는 의료 현장에서 실용적으로 활용 가능한 수준
- 폐렴 환자 놓침률 2.6%는 임상적으로 허용 가능

**특이도 관점**
- 70.1%는 불필요한 추가 검사를 상당 수준 감소
- 의료비용 절감과 환자 편의성 향상에 기여

### 5.3 활용 시나리오별 권고안

**1순위: 균형잡힌 진단 보조 시스템**
- **모델**: DenseNet-121 + Partial Fine-Tuning
- **용도**: 방사선과 전문의 판독 보조
- **장점**: 최고 테스트 성능과 균형잡힌 민감도/특이도

**2순위: 고민감도 스크리닝 시스템**
- **모델**: DenseNet-121 + Frozen
- **용도**: 응급실, 일차 진료소 초기 선별
- **장점**: 99.2% 민감도로 폐렴 놓침 최소화

---

## 6. 결론

### 7.1 핵심 연구 성과
본 연구는 흉부 X-Ray 기반 폐렴 분류에서 **DenseNet-121 + Partial Fine-Tuning 조합**이 최적임을 실험적으로 입증했다. 87.2%의 테스트 정확도와 97.4%의 민감도는 실제 의료 현장에서 활용 가능한 수준이다.

### 7.2 최종 권고 모델

**의료 현장 배포용 (1순위)**
- **모델**: DenseNet-121 + Partial Fine-Tuning
- **성능**: Test Acc 87.2%, Sensitivity 97.4%, Specificity 70.1%
- **용도**: 방사선과 전문의 진단 보조 시스템

**응급 스크리닝용 (2순위)**
- **모델**: DenseNet-121 + Frozen
- **성능**: Test Acc 86.7%, Sensitivity 99.2%, Specificity 65.8%
- **용도**: 응급실, 야간 진료 초기 선별 시스템

---

